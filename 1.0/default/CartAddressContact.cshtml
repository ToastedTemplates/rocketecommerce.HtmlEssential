@inherits RocketEcommerce.Components.RocketEcommerceTokens<Simplisity.SimplisityRazor>
@using DNNrocketAPI;
@using Simplisity;
@using RocketEcommerce.Components;
@using DNNrocketAPI.Components;
@using System.Globalization;

@AddProcessData("resourcepath", "/DesktopModules/RocketThemes/rocketecommerce/HtmlClickAndCollect/1.0/resx/")
@AddProcessData("resourcepath", "/DesktopModules/DNNrocket/api/App_LocalResources/")
@AddProcessData("resourcepath", "/DesktopModules/DNNrocketModules/RocketECommerce/App_LocalResources/")

@{
    var info = new SimplisityInfo();
    var cartData = (CartLimpet)Model.List.First();
    if (cartData.Record != null)
    {
        info = new SimplisityInfo(cartData.Record);
    }

    var remoteParam = (RemoteLimpet)Model.GetDataObject("remoteparam");

    // We need the moduleid, the first remote call will have the moduleid, subsequent call need to have the remote module passed by the s-field
    var moduleId = Model.ModuleId;
    var tabId = Model.TabId;
    if (remoteParam != null)
    {
        moduleId = remoteParam.ModuleId;
        tabId = remoteParam.TabId;
    }
    var portalShop = (PortalShopLimpet)Model.GetDataObject("portalshop");
    var systemInfoData = new SystemLimpet("rocketecommerce");
    var rocketInterface = new RocketInterface(systemInfoData.Info, "settingcountry");
    var companyData = new CompanyLimpet(portalShop.PortalId, DNNrocketUtils.GetCurrentCulture());

}
@AddProcessData("resourcepath", "/DesktopModules/RocketThemes/rocketecommerce/" + portalShop.AppTheme.AppThemeFolder + "/" + portalShop.AppTheme.AppVersionFolder + "/resx/")

    <div id="datasection" class="w3-container">
        <div id="contactdetails">
            <h3>@ResourceKey("RE.contactdetails", remoteParam.CultureCode)</h3>
            <div class="w3-margin-bottom">
                <label>@ResourceKey("RE.firstname", remoteParam.CultureCode)</label>
                @TextBox(info, "genxml/textbox/firstname", " class='w3-input w3-border' ")
            </div>
            <div class="w3-margin-bottom">
                <label>@ResourceKey("RE.lastname", remoteParam.CultureCode)</label>
                @TextBox(info, "genxml/textbox/lastname", " class='w3-input w3-border'  ")
            </div>
            <div class="w3-margin-bottom">
                <label>@ResourceKey("RE.email", remoteParam.CultureCode)</label>
                @TextBox(info, "genxml/textbox/email", " class='w3-input w3-border' name='email' required email ")
            </div>
            <div class="w3-margin-bottom">
                <label>@ResourceKey("RE.phone", remoteParam.CultureCode)</label>
                @TextBox(info, "genxml/textbox/phone", " class='w3-input w3-border' ")
            </div>
            <div class="w3-margin-bottom">
                <label>@ResourceKey("RE.specialinstructions", remoteParam.CultureCode)</label>
                @TextArea(info, "genxml/contact/clientnotes", " class='w3-input w3-border' rows='4' ")
            </div>

            @RenderTemplate("CollectionSelectTimes.cshtml", "\\DesktopModules\\RocketThemes\\rocketecommerce", portalShop.AppTheme.AppThemeFolder, Model, portalShop.AppTheme.AppVersionFolder, true)

        </div>


        <div class="w3-row w3-margin-top w3-margin-bottom">
            <div class="w3-button w3-border w3-left w3-margin-bottom simplisity_click" s-cmd="rocketecommerce_cartlist" s-return='.ecommerce-container' s-fields='{"systemkey":"rocketecommerce","template":"cartlist.cshtml"}'>@ButtonText(ButtonTypes.previous, remoteParam.CultureCode)</div>
            <div class="w3-button w3-border w3-right w3-margin-left w3-margin-bottom dovalidate simplisity_click" s-before="validatePayment" s-post="#datasection" s-cmd="rocketecommerce_savecartcontact" s-return='.ecommerce-container' s-fields='{"systemkey":"rocketecommerce","template":"cartaddressbill.cshtml"}'>@ButtonText(ButtonTypes.next, remoteParam.CultureCode)</div>
            <div class="w3-button w3-border w3-right w3-margin-bottom w3-light-grey" onclick="location.reload();return false;">@ResourceKey("RE.continueshopping", remoteParam.CultureCode)</div>
            <div class="w3-button w3-border w3-right w3-margin-right w3-margin-bottom simplisity_click " s-cmd="rocketecommerce_cartdetails" s-return='.ecommerce-container' s-fields='{"systemkey":"rocketecommerce","template":"cartaddresscontact.cshtml"}'>@ButtonIcon(ButtonTypes.refresh, remoteParam.CultureCode)</div>
        </div>

    </div>

<script>
    jQuery(document).ready(function () {
    });
</script>



